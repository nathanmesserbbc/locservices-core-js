!function(a,b){return"function"==typeof define&&define.amd?define(b):("undefined"==typeof a.locservices&&(a.locservices={}),"undefined"==typeof a.locservices.core&&(a.locservices.core={}),a.locservices.core.API=b(),void 0)}(this,function(){"use strict";function a(a,b){var c;for(c in a)a.hasOwnProperty(c)&&!b.hasOwnProperty(c)&&(b[c]=a[c]);return b}function b(b){var d,e="";this._defaultParams={},this._options=a({env:"live",protocol:"http"},b||{});var f=c(this._options);for(d in f)f.hasOwnProperty(d)&&"env"!==d&&"protocol"!==d&&(this._defaultParams[d]=f[d]);"live"!==this._options.env&&(e="."+this._options.env),this._baseUri=this._options.protocol+"://open."+this._options.env+".bbc.co.uk/locator",this._palBaseUri=this._options.protocol+"://www"+e+".bbc.co.uk/locator/default",this._hasXHR="undefined"!=typeof window.XMLHttpRequest}function c(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&((typeof a[b]).match(/string|number/)?c[b]=a[b]:"[object Array]"===Object.prototype.toString.call(a[b])&&(c[b]=a[b].join(",")));return c}b.prototype.getDefaultQueryParameters=function(){return this._defaultParams},b.prototype.getLocation=function(b,d){var e="",f="location";d.params=a(this._defaultParams,c(d||{})),d.detailTypes&&"[object Array]"===Object.prototype.toString.call(d.detailTypes)&&(f="details",e="/details/"+d.detailTypes.join(","),d.params.vv=2);var g="/locations/"+encodeURIComponent(b)+e;this.request(g,d,f)},b.prototype.search=function(b,d){function e(){var a=d.success,c=b,e=d.params.start;return function(b){b.metadata.search=c,e&&(b.metadata.start=e),a(b)}}d.params=a(this._defaultParams,c(d||{})),d.params.s=b,d.success=e(),this.request("/locations",d,"search")},b.prototype.autoComplete=function(b,d){d.params=a(this._defaultParams,c(d||{})),d.params.s=b,d.params.a="true",this.request("/locations",d,"autoComplete")},b.prototype.reverseGeocode=function(b,d,e){e.params=a(this._defaultParams,c(e||{})),e.params.lo=d,e.params.la=b,this.request("/locations",e,"reverseGeocode")},b.prototype.getCookie=function(a,b){b.params=b.params||{},b.params.id=a,this.request("/shared/location.json",b,"cookie")},b.prototype.request=function(a,b,c){b.params.format="json";var g,h="function"==typeof window.addEventListener?window.addEventListener:window.attachEvent,i="function"==typeof window.removeEventListener?window.removeEventListener:window.detachEvent,j=a+f(b.params),k=this,l=!1,m=function(a){a.onload=function(d){if(b.success&&d.target.status<400){var f;try{f=q(a.responseText),b.success(e(f,c))}catch(g){b.error&&b.error()}}else b.error&&b.error();window.ActiveXObject&&i("onunload",n)},b.error&&(a.onerror=b.error)},n=function(){l=!0,g.onload=g.onerror=null,g.abort()},o=function(a){l||"function"!=typeof b.error||b.error(a)};window.ActiveXObject&&h("onunload",n);var p=function(a){return"cookie"===c||"pal"===a?k._palBaseUri+j:k._baseUri+j},q=function(a){if(window.JSON&&window.JSON.parse)try{return window.JSON.parse(a)}catch(b){return null}return"string"==typeof a?new Function("return "+a)():null};if(this._hasXHR&&(g=new XMLHttpRequest),g&&"withCredentials"in g)try{g.open("GET",p("api"),!0),m(g)}catch(r){o(r)}else if("undefined"!=typeof window.XDomainRequest)g=new XDomainRequest,g.open("GET",p("api")),m(g);else if(g)try{g.open("GET",p("pal")),m(g)}catch(r){o(r)}else"undefined"!=typeof window.ActiveXObject?(g=new ActiveXObject("Microsoft.XMLHTTP"),g.open("GET",p("pal"),!0),g.onreadystatechange=function(){if(4===g.readyState)if(b.success&&g.status<400){var a;try{a=q(g.responseText),setTimeout(function(){b.success(e(a,c))})}catch(d){b.error&&b.error()}}else b.error&&b.error();window.ActiveXObject&&i("onunload",n)}):d(p("api"),b,c);if("undefined"!=typeof g)try{g.send(null)}catch(s){throw n(),s}};var d=function(a,b,c){var d,g;g="_locservices_core_api_cb_"+(new Date).getTime()+Math.round(1e5*Math.random()),b.params.format="jsonp",b.params.jsonp=g,window[g]=function(a){try{delete window[g]}catch(f){window[g]=void 0}document.body.removeChild(d),b.success&&b.success(e(a,c))},d=document.createElement("script"),d.src=a+f(b.params),"function"==typeof b.error&&(d.onerror=b.error),document.body.appendChild(d)},e=function(a,b){var c={};switch(b){case"cookie":c=a;break;case"location":c.location=a.response;break;case"details":c.location=a.response.metadata.location,c.details=a.response.content.details.details;break;case"search":c.results=a.response.locations,c.metadata={totalResults:a.response.totalResults};break;case"autoComplete":c.results=a.response.results.results,c.metadata={totalResults:a.response.results.totalResults};break;case"reverseGeocode":c.results=a.response.results.results}return c},f=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+"="+encodeURIComponent(a[c]));return"?"+b.join("&")};return b});
//# sourceMappingURL=api.min.map